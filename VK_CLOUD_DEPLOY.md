# –î–µ–ø–ª–æ–π FamilyCoins –Ω–∞ VK Cloud

## –ü–æ—á–µ–º—É VK Cloud?
- üÜì **3 –º–µ—Å—è—Ü–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ** –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üá∑üá∫ **–†–æ—Å—Å–∏–π—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- üöÄ **Kubernetes** –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- üóÑÔ∏è **Managed PostgreSQL –∏ Redis**
- üí∞ **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ —Ü–µ–Ω—ã** –ø–æ—Å–ª–µ trial –ø–µ—Ä–∏–æ–¥–∞

## –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ VK Cloud

1. –ò–¥–∏—Ç–µ –Ω–∞ [cloud.vk.com](https://cloud.vk.com)
2. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å (–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ VK/Mail.ru)
3. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ trial –Ω–∞ 3000‚ÇΩ
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω: –ú–æ—Å–∫–≤–∞

## –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL

### 2.1 –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
1. **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** ‚Üí **–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä**
2. **PostgreSQL 15**
3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: Basic (1 vCPU, 2GB RAM)
4. **–ò–º—è –∫–ª–∞—Å—Ç–µ—Ä–∞**: `familycoins-db`
5. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: `familycoins`
6. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: `familycoins_user`
7. **–ü–∞—Ä–æ–ª—å**: —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π

### 2.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏
- **–ü–æ–¥—Å–µ—Ç—å**: default
- **–ì—Ä—É–ø–ø–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**: —Ä–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ—Ä—Ç 5432
- **–ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø**: –î–∞ (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)

## –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ Redis

1. **–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** ‚Üí **Redis** ‚Üí **–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä**
2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: Basic
3. **–ò–º—è**: `familycoins-redis`
4. **–ë–µ–∑ –ø–∞—Ä–æ–ª—è** (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã) –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å

## –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞

### 4.1 –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞
1. **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** ‚Üí **Kubernetes** ‚Üí **–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä**
2. **–ò–º—è**: `familycoins-k8s`
3. **–í–µ—Ä—Å–∏—è**: 1.28 (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è)
4. **–¢–∏–ø —Å–µ—Ç–∏**: Calico
5. **–ì—Ä—É–ø–ø–∞ —É–∑–ª–æ–≤**:
   - **–¢–∏–ø –í–ú**: STD2-2-4 (2 vCPU, 4GB RAM)
   - **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤**: 1
   - **–ê–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**: –≤–∫–ª—é—á–∏—Ç—å

### 4.2 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–ª–∞—Å—Ç–µ—Ä—É
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ kubectl –µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç
curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/darwin/amd64/kubectl"
chmod +x kubectl
sudo mv kubectl /usr/local/bin/

# –°–∫–∞—á–∞–π—Ç–µ kubeconfig –∏–∑ VK Cloud –ø–∞–Ω–µ–ª–∏
# –§–∞–π–ª ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ ‚Üí –°–∫–∞—á–∞—Ç—å kubeconfig
```

## –®–∞–≥ 5: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤ Kubernetes

### 5.1 Namespace
```yaml
# k8s/namespace.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: familycoins
---
```

### 5.2 ConfigMap —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
```yaml
# k8s/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: familycoins-config
  namespace: familycoins
data:
  ENVIRONMENT: "production"
  DEBUG: "false"
  LOG_LEVEL: "INFO"
  API_V1_STR: "/v1"
---
```

### 5.3 Secret —Å –ø–∞—Ä–æ–ª—è–º–∏
```yaml
# k8s/secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: familycoins-secret
  namespace: familycoins
type: Opaque
stringData:
  JWT_SECRET_KEY: "your_super_secret_jwt_key_min_32_chars"
  DATABASE_URL: "postgresql+asyncpg://familycoins_user:password@postgres-host:5432/familycoins"
  REDIS_URL: "redis://redis-host:6379"
---
```

### 5.4 Deployment
```yaml
# k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: familycoins-api
  namespace: familycoins
spec:
  replicas: 2
  selector:
    matchLabels:
      app: familycoins-api
  template:
    metadata:
      labels:
        app: familycoins-api
    spec:
      containers:
      - name: api
        image: cr.cloud.vk.com/your-registry/familycoins:latest
        ports:
        - containerPort: 8000
        env:
        - name: PORT
          value: "8000"
        envFrom:
        - configMapRef:
            name: familycoins-config
        - secretRef:
            name: familycoins-secret
        resources:
          requests:
            memory: "256Mi"
            cpu: "250m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 5
          periodSeconds: 5
---
```

### 5.5 Service
```yaml
# k8s/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: familycoins-service
  namespace: familycoins
spec:
  selector:
    app: familycoins-api
  ports:
  - port: 80
    targetPort: 8000
  type: LoadBalancer
---
```

## –®–∞–≥ 6: –ó–∞–≥—Ä—É–∑–∫–∞ Docker –æ–±—Ä–∞–∑–∞

### 6.1 –°–æ–∑–¥–∞–Ω–∏–µ Container Registry
1. **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã** ‚Üí **Container Registry** ‚Üí **–°–æ–∑–¥–∞—Ç—å —Ä–µ–µ—Å—Ç—Ä**
2. **–ò–º—è**: `familycoins-registry`

### 6.2 –°–±–æ—Ä–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞–∑–∞
```bash
# –ü–æ–ª—É—á–∏—Ç–µ –∞–¥—Ä–µ—Å —Ä–µ–µ—Å—Ç—Ä–∞ –∏–∑ VK Cloud –ø–∞–Ω–µ–ª–∏
REGISTRY_URL="cr.cloud.vk.com/your-project/familycoins"

# –°–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑
docker build -t $REGISTRY_URL:latest ./backend

# –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –≤ —Ä–µ–µ—Å—Ç—Ä–µ (—Ç–æ–∫–µ–Ω –∏–∑ –ø–∞–Ω–µ–ª–∏ VK Cloud)
docker login cr.cloud.vk.com -u oauth -p your_oauth_token

# –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±—Ä–∞–∑
docker push $REGISTRY_URL:latest
```

## –®–∞–≥ 7: –î–µ–ø–ª–æ–π –≤ Kubernetes

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –≤—Å–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã
kubectl apply -f k8s/

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
kubectl get pods -n familycoins
kubectl get services -n familycoins

# –ü–æ–ª—É—á–∏—Ç–µ –≤–Ω–µ—à–Ω–∏–π IP
kubectl get service familycoins-service -n familycoins
```

## –®–∞–≥ 8: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 8.1 –ß–µ—Ä–µ–∑ VK Cloud DNS
1. **–°–µ—Ç—å** ‚Üí **DNS** ‚Üí **–°–æ–∑–¥–∞—Ç—å –∑–æ–Ω—É**
2. –î–æ–±–∞–≤—å—Ç–µ A-–∑–∞–ø–∏—Å—å —Å –≤–Ω–µ—à–Ω–∏–º IP LoadBalancer

### 8.2 SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
```yaml
# –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cert-manager –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö Let's Encrypt —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
```

## –°—Ç–æ–∏–º–æ—Å—Ç—å

### Trial (3 –º–µ—Å—è—Ü–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- **PostgreSQL**: ~500‚ÇΩ/–º–µ—Å—è—Ü
- **Redis**: ~300‚ÇΩ/–º–µ—Å—è—Ü  
- **Kubernetes**: ~800‚ÇΩ/–º–µ—Å—è—Ü
- **Container Registry**: ~100‚ÇΩ/–º–µ—Å—è—Ü
- **–¢—Ä–∞—Ñ–∏–∫**: ~200‚ÇΩ/–º–µ—Å—è—Ü
- **–ò—Ç–æ–≥–æ**: ~1900‚ÇΩ/–º–µ—Å—è—Ü (–ø–æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è trial)

### –ü–æ—Å–ª–µ trial
- **–°–∫–∏–¥–∫–∞ 50%** –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ –∑–∞ –≥–æ–¥
- **–†–µ–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å**: ~950‚ÇΩ/–º–µ—Å—è—Ü

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç: Compute Cloud VM

–ï—Å–ª–∏ Kubernetes –∫–∞–∂–µ—Ç—Å—è —Å–ª–æ–∂–Ω—ã–º:

```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ –í–ú Ubuntu 22.04 (2 vCPU, 4GB RAM)
# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker
curl -fsSL https://get.docker.com | sh

# 3. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/ironborrus-star/familycoins.git

# 4. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ë–î
# 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
cd familycoins
docker-compose -f backend/docker-compose.prod.yml up -d
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

VK Cloud –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- üìä **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** Kubernetes
- üìù **–õ–æ–≥–∏** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üö® **–ê–ª–µ—Ä—Ç—ã** –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º
- üìà **Grafana dashboards**

---

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ VK Cloud:**
- üá∑üá∫ –†–æ—Å—Å–∏–π—Å–∫–∞—è —é—Ä–∏—Å–¥–∏–∫—Ü–∏—è
- üí∞ –•–æ—Ä–æ—à–∏–µ —Ü–µ–Ω—ã
- üÜì –î–ª–∏—Ç–µ–ª—å–Ω—ã–π trial
- üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- üîß Managed —Å–µ—Ä–≤–∏—Å—ã
